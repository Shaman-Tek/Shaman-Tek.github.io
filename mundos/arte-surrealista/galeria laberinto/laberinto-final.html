<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laberinto Onírico — ShamanTek</title>
    <meta name="description" content="Una galería interactiva de arte surrealista. Navega entre nodos, revela capas ocultas y consulta al oráculo.">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="../../../favicon.svg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Space+Mono:ital@0;1&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../../../styles/arte-surrealista.css">
    <link rel="stylesheet" href="../../../styles/laberinto.css">
</head>
<body>

    <!-- Audio Ambiental -->
    <audio id="ambient-audio" loop preload="auto">
        <source src="../Threshold of the Amethyst Gate.mp3" type="audio/mpeg">
    </audio>

    <!-- ============================================
         PANTALLA DE RITUAL
         ============================================ -->
    <div id="ritual-screen">
        <!-- Control de Audio -->
        <button id="audio-toggle" class="audio-toggle" title="Silenciar/Activar sonido">
            <span class="audio-icon audio-on">♪</span>
            <span class="audio-icon audio-off" style="display:none;">♪̸</span>
        </button>

        <div class="ritual-container">
            <div class="ritual-title">Ritual de Entrada</div>

            <div class="ritual-question active" data-question="1">
                <p class="question-text">¿Qué hora es donde estás?</p>
                <div class="question-options">
                    <button class="option-btn" data-value="dawn" data-aspect="time">Amanecer</button>
                    <button class="option-btn" data-value="day" data-aspect="time">Día</button>
                    <button class="option-btn" data-value="dusk" data-aspect="time">Atardecer</button>
                    <button class="option-btn" data-value="night" data-aspect="time">Noche</button>
                </div>
            </div>

            <div class="ritual-question" data-question="2">
                <p class="question-text">Cerrá los ojos un momento. ¿Qué ves?</p>
                <div class="question-options">
                    <button class="option-btn" data-value="void" data-aspect="inner">Oscuridad</button>
                    <button class="option-btn" data-value="colors" data-aspect="inner">Colores flotando</button>
                    <button class="option-btn" data-value="shapes" data-aspect="inner">Formas geométricas</button>
                    <button class="option-btn" data-value="faces" data-aspect="inner">Rostros o figuras</button>
                </div>
            </div>

            <div class="ritual-question" data-question="3">
                <p class="question-text">¿Qué animal visitó tu último sueño?</p>
                <div class="question-options">
                    <button class="option-btn" data-value="bird" data-aspect="animal">Pájaro</button>
                    <button class="option-btn" data-value="serpent" data-aspect="animal">Serpiente</button>
                    <button class="option-btn" data-value="feline" data-aspect="animal">Felino</button>
                    <button class="option-btn" data-value="none" data-aspect="animal">Ninguno que recuerde</button>
                </div>
            </div>

            <div class="ritual-question" data-question="4">
                <p class="question-text">¿Qué buscás aquí?</p>
                <div class="question-options">
                    <button class="option-btn" data-value="lost" data-aspect="intent">Perderme</button>
                    <button class="option-btn" data-value="find" data-aspect="intent">Encontrar algo</button>
                    <button class="option-btn" data-value="feel" data-aspect="intent">Sentir</button>
                    <button class="option-btn" data-value="unknown" data-aspect="intent">No lo sé</button>
                </div>
            </div>
        </div>

        <div class="ritual-progress">
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>
    </div>

    <!-- ============================================
         LABERINTO PRINCIPAL
         ============================================ -->
    <div id="labyrinth">

        <!-- Navegación -->
        <nav class="labyrinth-nav">
            <a href="../index.html" class="nav-sigil nav-back" title="Salir del Laberinto">&larr;</a>
            <button id="audio-toggle-lab" class="nav-sigil audio-toggle-lab" title="Silenciar/Activar sonido">
                <span class="audio-icon audio-on">♪</span>
                <span class="audio-icon audio-off" style="display:none;">♪̸</span>
            </button>
            <a href="../Threshold of the Amethyst Gate.mp3" download class="nav-sigil nav-download-audio" title="Descargar música">⤓</a>
            <div class="nav-sigil" id="reset-btn" title="Reiniciar">&#9675;</div>
        </nav>

        <!-- Indicador de nodos visitados -->
        <div class="node-indicator">
            <div class="node-dot active" data-node="umbral" title="El Umbral"></div>
            <div class="node-dot" data-node="agua" title="El Agua"></div>
            <div class="node-dot" data-node="espejo" title="El Espejo"></div>
            <div class="node-dot" data-node="bosque" title="El Bosque"></div>
            <div class="node-dot" data-node="abismo" title="El Abismo"></div>
        </div>

        <!-- ============================================
             NODO I: EL UMBRAL
             ============================================ -->
        <section class="dream-node active" data-node="umbral" id="node-umbral">
            <span class="dream-number">I</span>
            <div class="node-title">El Umbral</div>

            <div class="artwork-container" data-artwork="umbral">
                <div class="loading-state"></div>
                <div class="artwork-layer layer-base" style="background-image: url('umbral-capa1.png');"></div>
                <div class="artwork-layer layer-hidden" style="background-image: url('umbral-capa2.png');"></div>
                <div class="artwork-layer layer-deep" style="background-image: url('umbral-capa3.png');"></div>
                <div class="layer-indicator">
                    <div class="layer-dot active" data-layer="1"></div>
                    <div class="layer-dot" data-layer="2"></div>
                    <div class="layer-dot" data-layer="3"></div>
                </div>
                <div class="artwork-download">
                    <a href="umbral-capa1.png" download="umbral-capa1.png" title="Descargar capa 1">⤓1</a>
                    <a href="umbral-capa2.png" download="umbral-capa2.png" title="Descargar capa 2">⤓2</a>
                    <a href="umbral-capa3.png" download="umbral-capa3.png" title="Descargar capa 3">⤓3</a>
                </div>
            </div>

            <div class="portals">
                <a class="portal" data-target="agua">hacia el agua</a>
                <a class="portal" data-target="espejo">hacia el espejo</a>
                <a class="portal" data-target="bosque">hacia el bosque</a>
            </div>
        </section>

        <!-- ============================================
             NODO II: EL AGUA
             ============================================ -->
        <section class="dream-node" data-node="agua" id="node-agua">
            <span class="dream-number">II</span>
            <div class="node-title">El Agua</div>

            <div class="artwork-container" data-artwork="agua">
                <div class="loading-state"></div>
                <div class="artwork-layer layer-base" style="background-image: url('agua-capa1.png');"></div>
                <div class="artwork-layer layer-hidden" style="background-image: url('agua-capa2.png');"></div>
                <div class="artwork-layer layer-deep" style="background-image: url('agua-capa3.png');"></div>
                <div class="layer-indicator">
                    <div class="layer-dot active" data-layer="1"></div>
                    <div class="layer-dot" data-layer="2"></div>
                    <div class="layer-dot" data-layer="3"></div>
                </div>
                <div class="artwork-download">
                    <a href="agua-capa1.png" download="agua-capa1.png" title="Descargar capa 1">⤓1</a>
                    <a href="agua-capa2.png" download="agua-capa2.png" title="Descargar capa 2">⤓2</a>
                    <a href="agua-capa3.png" download="agua-capa3.png" title="Descargar capa 3">⤓3</a>
                </div>
            </div>

            <div class="portals">
                <a class="portal" data-target="umbral">volver al umbral</a>
                <a class="portal" data-target="espejo">atravesar hacia el espejo</a>
                <a class="portal" data-target="abismo">descender al abismo</a>
            </div>
        </section>

        <!-- ============================================
             NODO III: EL ESPEJO
             ============================================ -->
        <section class="dream-node" data-node="espejo" id="node-espejo">
            <span class="dream-number">III</span>
            <div class="node-title">El Espejo</div>

            <div class="artwork-container" data-artwork="espejo">
                <div class="loading-state"></div>
                <div class="artwork-layer layer-base" style="background-image: url('espejo-capa1.png');"></div>
                <div class="artwork-layer layer-hidden" style="background-image: url('espejo-capa2.png');"></div>
                <div class="artwork-layer layer-deep" style="background-image: url('espejo-capa3.png');"></div>
                <div class="layer-indicator">
                    <div class="layer-dot active" data-layer="1"></div>
                    <div class="layer-dot" data-layer="2"></div>
                    <div class="layer-dot" data-layer="3"></div>
                </div>
                <div class="artwork-download">
                    <a href="espejo-capa1.png" download="espejo-capa1.png" title="Descargar capa 1">⤓1</a>
                    <a href="espejo-capa2.png" download="espejo-capa2.png" title="Descargar capa 2">⤓2</a>
                    <a href="espejo-capa3.png" download="espejo-capa3.png" title="Descargar capa 3">⤓3</a>
                </div>
            </div>

            <div class="portals">
                <a class="portal" data-target="umbral">escapar al umbral</a>
                <a class="portal" data-target="bosque">internarse en el bosque</a>
                <a class="portal" data-target="abismo">caer al abismo</a>
            </div>
        </section>

        <!-- ============================================
             NODO IV: EL BOSQUE
             ============================================ -->
        <section class="dream-node" data-node="bosque" id="node-bosque">
            <span class="dream-number">IV</span>
            <div class="node-title">El Bosque</div>

            <div class="artwork-container" data-artwork="bosque">
                <div class="loading-state"></div>
                <div class="artwork-layer layer-base" style="background-image: url('bosque-capa1.png');"></div>
                <div class="artwork-layer layer-hidden" style="background-image: url('bosque-capa2.png');"></div>
                <div class="artwork-layer layer-deep" style="background-image: url('bosque-capa3.png');"></div>
                <div class="layer-indicator">
                    <div class="layer-dot active" data-layer="1"></div>
                    <div class="layer-dot" data-layer="2"></div>
                    <div class="layer-dot" data-layer="3"></div>
                </div>
                <div class="artwork-download">
                    <a href="bosque-capa1.png" download="bosque-capa1.png" title="Descargar capa 1">⤓1</a>
                    <a href="bosque-capa2.png" download="bosque-capa2.png" title="Descargar capa 2">⤓2</a>
                    <a href="bosque-capa3.png" download="bosque-capa3.png" title="Descargar capa 3">⤓3</a>
                </div>
            </div>

            <div class="portals">
                <a class="portal" data-target="umbral">regresar al umbral</a>
                <a class="portal" data-target="espejo">reflejarse en el espejo</a>
                <a class="portal" data-target="abismo">la grieta hacia el abismo</a>
            </div>
        </section>

        <!-- ============================================
             NODO V: EL ABISMO
             ============================================ -->
        <section class="dream-node" data-node="abismo" id="node-abismo">
            <span class="dream-number">V</span>
            <div class="node-title">El Abismo</div>

            <div class="artwork-container" data-artwork="abismo">
                <div class="loading-state"></div>
                <div class="artwork-layer layer-base" style="background-image: url('abismo-capa1.png');"></div>
                <div class="artwork-layer layer-hidden" style="background-image: url('abismo-capa2.png');"></div>
                <div class="artwork-layer layer-deep" style="background-image: url('abismo-capa3.png');"></div>
                <div class="layer-indicator">
                    <div class="layer-dot active" data-layer="1"></div>
                    <div class="layer-dot" data-layer="2"></div>
                    <div class="layer-dot" data-layer="3"></div>
                </div>
                <div class="artwork-download">
                    <a href="abismo-capa1.png" download="abismo-capa1.png" title="Descargar capa 1">⤓1</a>
                    <a href="abismo-capa2.png" download="abismo-capa2.png" title="Descargar capa 2">⤓2</a>
                    <a href="abismo-capa3.png" download="abismo-capa3.png" title="Descargar capa 3">⤓3</a>
                </div>
            </div>

            <div class="portals">
                <a class="portal" data-target="umbral">despertar</a>
                <a class="portal" data-target="agua">emerger en el agua</a>
                <a class="portal" data-target="bosque">ascender al bosque</a>
            </div>
        </section>

        <!-- Instrucciones sutiles -->
        <div class="whisper" id="whisper">
            pasá el cursor sobre la imagen
            <span class="whisper-hint">mantené presionado para revelar lo oculto</span>
        </div>

        <!-- Trigger oculto del oráculo -->
        <div class="oracle-trigger" id="oracle-trigger" title="&#8258;">
            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="2"/><circle cx="12" cy="4" r="1.5"/><circle cx="12" cy="20" r="1.5"/><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></svg>
        </div>
    </div>

    <!-- ============================================
         ORÁCULO
         ============================================ -->
    <div id="oracle">
        <button class="oracle-close" id="oracle-close">cerrar [&times;]</button>
        <div class="oracle-title">El Oráculo</div>
        <p class="oracle-instruction">Formulá tu pregunta en silencio, o escribila si preferís</p>
        <input type="text" class="oracle-input" id="oracle-input" placeholder="(opcional)">
        <button class="oracle-consult" id="oracle-consult">Consultar</button>

        <div class="oracle-response" id="oracle-response">
            <div class="oracle-image" id="oracle-image"></div>
            <p class="oracle-fragment" id="oracle-text"></p>
        </div>
    </div>

    <!-- ============================================
         EASTER EGG: EL SEXTO NODO (SECRETO)
         Actívalo visitando los 5 nodos en orden:
         Umbral → Agua → Espejo → Bosque → Abismo
         ============================================ -->
    <div id="secret-node" class="secret-realm">
        <div class="secret-content">
            <div class="secret-title">VI</div>
            <div class="secret-name">El Despertar</div>
            <p class="secret-message">
                Has recorrido el laberinto completo.<br>
                El sueño y la vigilia son uno.<br>
                <span class="secret-reveal">El observador y lo observado siempre fueron lo mismo.</span>
            </p>
            <div class="secret-art">
                <svg viewBox="0 0 200 200" class="mandala">
                    <defs>
                        <radialGradient id="mandala-gradient">
                            <stop offset="0%" stop-color="var(--surreal-gold)"/>
                            <stop offset="100%" stop-color="transparent"/>
                        </radialGradient>
                    </defs>
                    <circle cx="100" cy="100" r="80" fill="none" stroke="var(--surreal-gold)" stroke-width="0.5" opacity="0.3"/>
                    <circle cx="100" cy="100" r="60" fill="none" stroke="var(--surreal-gold)" stroke-width="0.5" opacity="0.4"/>
                    <circle cx="100" cy="100" r="40" fill="none" stroke="var(--surreal-gold)" stroke-width="0.5" opacity="0.5"/>
                    <circle cx="100" cy="100" r="20" fill="none" stroke="var(--surreal-gold)" stroke-width="0.5" opacity="0.6"/>
                    <circle cx="100" cy="100" r="5" fill="var(--surreal-gold)" opacity="0.8"/>
                    <!-- Pétalos -->
                    <g class="petals" style="transform-origin: center;">
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(45 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(90 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(135 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(180 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(225 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(270 100 100)"/>
                        <ellipse cx="100" cy="40" rx="8" ry="25" fill="none" stroke="var(--surreal-ghost)" stroke-width="0.5" opacity="0.4" transform="rotate(315 100 100)"/>
                    </g>
                </svg>
            </div>
            <button class="secret-close" id="secret-close">despertar</button>
        </div>
    </div>

    <!--
    ╔═══════════════════════════════════════════════════════════════╗
    ║                                                               ║
    ║     ░▒▓█ ENCONTRASTE ALGO OCULTO █▓▒░                        ║
    ║                                                               ║
    ║           .-""""""-.                                          ║
    ║         .'          '.                                        ║
    ║        /   O      O   \                                       ║
    ║       :                :                                      ║
    ║       |                |          El código fuente            ║
    ║       : ',          ,' :          es otro laberinto.          ║
    ║        \  '-......-'  /                                       ║
    ║         '.googly eyes'            Seguí buscando...           ║
    ║           '-......-'                                          ║
    ║                                                               ║
    ║     Pista: tecleá "sueño" en cualquier momento                ║
    ║                                                               ║
    ╚═══════════════════════════════════════════════════════════════╝
    -->

    <!-- OTRO SECRETO: Presiona 's' 'u' 'e' 'ñ' 'o' para ver algo especial -->

    <!-- Scripts -->
    <script src="../../../scripts/laberinto.js"></script>

    <!-- Easter Eggs Script -->
    <script>
    (function() {
        // ====== EASTER EGG 1: Secuencia de nodos ======
        const secretSequence = ['umbral', 'agua', 'espejo', 'bosque', 'abismo'];
        let visitOrder = [];

        // Escuchar navegación
        document.querySelectorAll('.portal').forEach(portal => {
            portal.addEventListener('click', function() {
                const target = this.dataset.target;
                if (visitOrder.length === 0 || visitOrder[visitOrder.length - 1] !== target) {
                    visitOrder.push(target);
                }
                // Verificar secuencia completa
                if (visitOrder.length >= 5) {
                    const lastFive = visitOrder.slice(-5);
                    if (JSON.stringify(lastFive) === JSON.stringify(secretSequence)) {
                        setTimeout(() => {
                            document.getElementById('secret-node').classList.add('revealed');
                        }, 2000);
                    }
                }
            });
        });

        // Cerrar nodo secreto
        document.getElementById('secret-close')?.addEventListener('click', function() {
            document.getElementById('secret-node').classList.remove('revealed');
            visitOrder = [];
        });

        // ====== EASTER EGG 2: Teclear "sueño" ======
        let konamiBuffer = '';
        const secretWord = 'sueño';

        document.addEventListener('keydown', function(e) {
            konamiBuffer += e.key.toLowerCase();
            if (konamiBuffer.length > 10) {
                konamiBuffer = konamiBuffer.slice(-10);
            }
            if (konamiBuffer.includes(secretWord)) {
                activateDreamMode();
                konamiBuffer = '';
            }
        });

        function activateDreamMode() {
            document.body.classList.add('dream-mode');
            // Crear partículas de sueño
            for (let i = 0; i < 30; i++) {
                createDreamParticle();
            }
            setTimeout(() => {
                document.body.classList.remove('dream-mode');
            }, 8000);
        }

        function createDreamParticle() {
            const particle = document.createElement('div');
            particle.className = 'dream-particle';
            particle.style.left = Math.random() * 100 + 'vw';
            particle.style.animationDuration = (3 + Math.random() * 4) + 's';
            particle.style.animationDelay = Math.random() * 2 + 's';
            particle.innerHTML = ['✦', '✧', '⋆', '｡', '°'][Math.floor(Math.random() * 5)];
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 8000);
        }

        // ====== EASTER EGG 3: Triple click en título del ritual ======
        let titleClicks = 0;
        document.querySelector('.ritual-title')?.addEventListener('click', function() {
            titleClicks++;
            if (titleClicks === 7) {
                this.innerHTML = '∞ El Infinito ∞';
                this.style.color = '#ff3366';
                setTimeout(() => {
                    this.innerHTML = 'Ritual de Entrada';
                    this.style.color = '';
                }, 3000);
                titleClicks = 0;
            }
        });
    })();
    </script>

    <!-- Audio Control Script -->
    <script>
    (function() {
        const audio = document.getElementById('ambient-audio');
        const toggleRitual = document.getElementById('audio-toggle');
        const toggleLab = document.getElementById('audio-toggle-lab');
        let audioStarted = false;
        let isMuted = false;

        // Fade in del volumen
        function fadeInAudio(duration = 3000) {
            audio.volume = 0;
            audio.currentTime = 190; // Empezar en 3:10
            audio.play().catch(e => console.log('Audio blocked:', e));

            const steps = 30;
            const stepTime = duration / steps;
            const volumeStep = 0.7 / steps; // Max volume 0.7
            let currentStep = 0;

            const fadeInterval = setInterval(() => {
                currentStep++;
                audio.volume = Math.min(0.7, volumeStep * currentStep);
                if (currentStep >= steps) {
                    clearInterval(fadeInterval);
                }
            }, stepTime);
        }

        // Iniciar audio en primera interacción del ritual
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (!audioStarted) {
                    audioStarted = true;
                    fadeInAudio();
                }
            }, { once: false });
        });

        // Toggle mute function
        function toggleMute() {
            isMuted = !isMuted;
            audio.muted = isMuted;

            // Sync both buttons
            [toggleRitual, toggleLab].forEach(btn => {
                if (btn) {
                    if (isMuted) {
                        btn.classList.add('muted');
                        btn.title = 'Activar sonido';
                    } else {
                        btn.classList.remove('muted');
                        btn.title = 'Silenciar';
                    }
                }
            });
        }

        // Event listeners for both toggle buttons
        toggleRitual?.addEventListener('click', toggleMute);
        toggleLab?.addEventListener('click', toggleMute);

        // Keyboard shortcut: 'M' to mute/unmute
        document.addEventListener('keydown', function(e) {
            if (e.key.toLowerCase() === 'm' && !e.ctrlKey && !e.altKey) {
                // Don't toggle if typing in oracle input
                if (document.activeElement.tagName !== 'INPUT') {
                    toggleMute();
                }
            }
        });

        // Pause audio when page is hidden (tab change)
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                audio.pause();
            } else if (audioStarted && !isMuted) {
                audio.play().catch(e => {});
            }
        });
    })();
    </script>

    <!-- Easter Egg Styles -->
    <style>
        /* Audio Toggle Button - Ritual Screen */
        .audio-toggle {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 1100;
            background: transparent;
            border: 1px solid var(--surreal-ghost, #9988bb);
            color: var(--surreal-ghost, #9988bb);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .audio-toggle:hover {
            border-color: var(--surreal-gold, #c9a227);
            color: var(--surreal-gold, #c9a227);
            transform: scale(1.1);
        }

        .audio-toggle.muted {
            opacity: 0.5;
        }

        .audio-toggle.muted .audio-on { display: none !important; }
        .audio-toggle.muted .audio-off { display: inline !important; }

        /* Audio Toggle - Labyrinth Nav */
        .audio-toggle-lab {
            background: transparent;
            border: none;
            color: var(--surreal-ghost, #9988bb);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
        }

        .audio-toggle-lab:hover {
            color: var(--surreal-gold, #c9a227);
            transform: scale(1.1);
        }

        .audio-toggle-lab.muted {
            opacity: 0.5;
        }

        .audio-toggle-lab.muted .audio-on { display: none !important; }
        .audio-toggle-lab.muted .audio-off { display: inline !important; }

        .audio-icon {
            pointer-events: none;
        }

        /* Nav Download Audio */
        .nav-download-audio {
            text-decoration: none;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .nav-download-audio:hover {
            color: var(--surreal-gold, #c9a227);
            transform: scale(1.1);
        }

        /* Artwork Download Buttons */
        .artwork-download {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .artwork-container:hover .artwork-download {
            opacity: 1;
        }

        .artwork-download a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: rgba(10, 8, 16, 0.8);
            border: 1px solid var(--surreal-ghost, #9988bb);
            border-radius: 4px;
            color: var(--surreal-ghost, #9988bb);
            text-decoration: none;
            font-size: 0.75rem;
            font-family: 'Space Mono', monospace;
            transition: all 0.3s ease;
        }

        .artwork-download a:hover {
            background: var(--surreal-gold, #c9a227);
            border-color: var(--surreal-gold, #c9a227);
            color: var(--surreal-void, #0a0810);
            transform: translateY(-2px);
        }

        /* Nav back link */
        .nav-back {
            text-decoration: none;
            font-size: 1.2rem;
        }

        /* Secret Node */
        .secret-realm {
            position: fixed;
            inset: 0;
            background: radial-gradient(ellipse at center, rgba(61, 47, 92, 0.95) 0%, rgba(10, 8, 16, 0.98) 70%);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 1.5s ease;
        }

        .secret-realm.revealed {
            opacity: 1;
            visibility: visible;
        }

        .secret-content {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
        }

        .secret-title {
            font-family: 'Space Mono', monospace;
            font-size: 3rem;
            color: var(--surreal-gold, #c9a227);
            margin-bottom: 1rem;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { text-shadow: 0 0 20px rgba(201, 162, 39, 0.5); }
            50% { text-shadow: 0 0 40px rgba(201, 162, 39, 0.8); }
        }

        .secret-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-style: italic;
            color: var(--surreal-ghost, #9988bb);
            margin-bottom: 2rem;
            letter-spacing: 0.3em;
        }

        .secret-message {
            font-size: 1.1rem;
            line-height: 2;
            color: var(--surreal-bone, #e8e4dc);
            margin-bottom: 2rem;
        }

        .secret-reveal {
            display: block;
            margin-top: 1rem;
            color: var(--surreal-gold, #c9a227);
            font-style: italic;
        }

        .secret-art {
            margin: 2rem 0;
        }

        .mandala {
            width: 150px;
            height: 150px;
            animation: rotate-slow 30s linear infinite;
        }

        @keyframes rotate-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .petals {
            animation: rotate-reverse 20s linear infinite;
        }

        @keyframes rotate-reverse {
            from { transform: rotate(0deg); }
            to { transform: rotate(-360deg); }
        }

        .secret-close {
            background: transparent;
            border: 1px solid var(--surreal-gold, #c9a227);
            color: var(--surreal-gold, #c9a227);
            padding: 1rem 2rem;
            font-family: 'Space Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 0.2em;
            cursor: pointer;
            transition: all 0.4s ease;
        }

        .secret-close:hover {
            background: var(--surreal-gold, #c9a227);
            color: var(--surreal-void, #0a0810);
        }

        /* Dream Mode */
        .dream-mode {
            animation: dream-filter 8s ease-in-out;
        }

        @keyframes dream-filter {
            0%, 100% { filter: none; }
            50% { filter: hue-rotate(30deg) saturate(1.3); }
        }

        .dream-particle {
            position: fixed;
            top: -20px;
            color: var(--surreal-gold, #c9a227);
            font-size: 1.5rem;
            pointer-events: none;
            z-index: 3000;
            animation: fall-dream linear forwards;
            opacity: 0.7;
        }

        @keyframes fall-dream {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.7; }
            90% { opacity: 0.7; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
    </style>
</body>
</html>
